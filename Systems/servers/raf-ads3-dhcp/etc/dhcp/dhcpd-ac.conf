ddns-updates on;
ddns-update-style interim;
update-static-leases true;
deny duplicates;

# We have purposely blocked dynamic allocation of IPs to unknown laptops.
# This policy gives NCAR's IT department the authority to 'vet' out the systems
# before they are introduced to the aircraft's network.  This 'vetting' process
# typically entails sweeping the systems for viruses and disabling
# automated updates which try to obtain new packages from the internet.
# deny unknown-clients;
allow unknown-clients;

one-lease-per-client on;
ping-check off;

# If client-updates are allowed, then a visiting client can ask for
# a name like  mypc.psu.edu. dhcpd will provide that
# name and will only ask DNS to update the PTR record and
# not the A record, and so DNS will not assign a name in the local
# domain.
ignore client-updates;
# allow client-updates;

# Whether to use the name of the host in the
# host xxx {} declaration for the host-name option.
use-host-decl-names on;

# This is the key used by the rndc program to start/stop/control named
include "/etc/rndc.key";

# This is the key used for updates between dhcpd and named
include "/etc/raf.ucar.edu.key";

# default domain
option domain-name "raf.ucar.edu";

###########################################################################
# Here's the plan for addresses, on both the .84 and .184 networks:
# 0-63: fixed address systems, least restrictive firewall rules (64 addrs)
# 64-159: fixed addresses (DSMs are 100-159), restrictive firewall (96 addrs)
# 160-223: dynamic addresses, restrictive firewall (64 addresses)
# 224-255: reserved (32 addresses)

# Info on the mapping of network/netmask to address range.
# network/netmask    address range
# 192.168.84.0/27    192.168.84.0-31
# 192.168.84.32/27   192.168.84.32-63
# 192.168.84.64/27   192.168.84.64-95
# 192.168.84.96/27   192.168.84.96-127
# 192.168.84.128/27  192.168.84.128-159
# 192.168.84.160/27  192.168.84.160-191
# 192.168.84.192/27  192.168.84.192-223
# 192.168.84.224/27  192.168.84.192-255
 
# 192.168.84.0/26    192.168.84.0-63
# 192.168.84.64/26   192.168.84.64-127
# 192.168.84.128/26  192.168.84.128-191
# 192.168.84.192/26  192.168.84.192-255

# 192.168.84.0/25    192.168.84.0-127
# 192.168.84.128/25  192.168.84.128-255
###########################################################################

subnet 192.168.84.0 netmask 255.255.255.0 {
  authoritative;
  range dynamic-bootp 192.168.84.160 192.168.84.223;
  option routers 192.168.84.1;
  option broadcast-address 192.168.84.255;
  option ntp-servers 192.168.184.10,192.168.84.1;
  option domain-name-servers 192.168.84.1;
  default-lease-time 86400;
  max-lease-time 86400;
  ddns-hostname = concat("dhcp-",binary-to-ascii(10,8,"-",leased-address));
}

subnet 192.168.184.0 netmask 255.255.255.0 {
  authoritative;
  range dynamic-bootp 192.168.184.160 192.168.184.223;
  option routers 192.168.184.1;
  option broadcast-address 192.168.184.255;
  option ntp-servers 192.168.184.10,192.168.184.1;
  option domain-name-servers 192.168.184.1;
  default-lease-time 86400;
  max-lease-time 86400;
  ddns-hostname = concat("dhcp-",binary-to-ascii(10,8,"-",leased-address));
}

subnet 128.117.0.0 netmask 255.255.0.0 {
  not authoritative;
}

zone raf.ucar.edu. {
   primary 127.0.0.1;
   key raf.ucar.edu;
}
zone 84.168.192.in-addr.arpa. {
   primary 127.0.0.1;
   key raf.ucar.edu;
}
zone 184.168.192.in-addr.arpa. {
   primary 127.0.0.1;
   key raf.ucar.edu;
}

# host entries must have different hostnames (the field after "host")
# but can have the same ddns-hostname.
# So if we have two systems that should have the same dns name on
# each aircraft, like "fwdcam", but have different MAC addresses,
# they can both be configured here with different names in the host xxx {}
# declaration, like fwdcam-gv and fwdcam-c130, but the same value for
# ddns-hostname and the same value for option host-name.
# This may reduce the need for different dhcpd configs on each plane.
group {
  # GV timeserver
  host timeserver-gv {
    hardware ethernet 00:0e:fe:00:04:a9;
    ddns-hostname "timeserver";
    option host-name  "timeserver";
    fixed-address 192.168.184.10;
  }

  # C130 fwdcam
  host fwdcam-c130 {
    hardware ethernet 00:40:8c:5c:0f:9d;
    ddns-hostname "fwdcam";
    option host-name "fwdcam";
  }

  # hubs
  # GV 84 subnet is a cisco, not netgear, perhaps c130?
  host netgear84-gv {
     hardware ethernet 00:09:5B:5A:F3:15;
     ddns-hostname "netgear84";
     option host-name "netgear84";
  }
  host netgear184-gv {
     hardware ethernet 00:09:5B:5A:F8:75;
     ddns-hostname "netgear184";
     option host-name "netgear184";
  }

  host gdm-pc {
     hardware ethernet 00:12:3f:f6:73:20;
     ddns-hostname "gdm-pc";
  }
  host hyper1-pc {
     hardware ethernet 00:11:43:6f:69:76;
     ddns-hostname "hyper1-pc";
  }
  host hyper2-pc {
     hardware ethernet 00:11:43:6f:69:ae;
     ddns-hostname "hyper2-pc";
  }
  host hyper3-pc {
     hardware ethernet 00:11:43:6f:69:2f;
     ddns-hostname "hyper3-pc";
  }
  host hyper4-pc {
     hardware ethernet 00:11:43:78:dc:ff;
     ddns-hostname "hyper4-pc";
  }
  host hyper5-pc {
     hardware ethernet 00:14:22:e6:d1:1d;
     ddns-hostname "hyper5-pc";
  }
  host eol-rdma {
     hardware ethernet 00:15:60:b6:0c:93;
     ddns-hostname "eol-rdma";
  }
  host accam {
     hardware ethernet 78:2B:CB:37:40:33;
     fixed-address 192.168.84.21;
     ddns-hostname "accam";
  }
  host 3vcpi {
     hardware ethernet 00:30:48:c5:25:ab;
     fixed-address 192.168.84.100;
     ddns-hostname "3vcpi";
  }
  host fo3cl-pc {
     hardware ethernet 00:80:2f:ab:c1:23;
     ddns-hostname "fo3cl-pc";
  }
  # Teresa's Ozone Instrument
  host fo3 {
     hardware ethernet 00:80:2f:0a:1b:e2;
     ddns-hostname "fo3";
  }
  host mtp-pc {
     hardware ethernet 00:15:17:58:f0:41;
     ddns-hostname "mtp-pc";
  }
  # Teresa's CO2 Picaro instrument
  host picco2 {
     hardware ethernet 00:03:2d:13:4a:6a;
     ddns-hostname "picco2";
  }
  host nonoy03-pc {
     hardware ethernet 00:80:2f:0a:5b:8c;
     ddns-hostname "nonoy03-pc";
  }
  host avaps-pc {
     hardware ethernet 00:1e:67:31:50:47;
     ddns-hostname "avaps-pc";
  }
  host adslap1 {
     hardware ethernet 70:58:12:20:4F:0A;
     ddns-hostname "adslap1";
     fixed-address 192.168.84.11;
  }
  host adslap2 {
     hardware ethernet 70:58:12:20:4E:43;
     ddns-hostname "adslap2";
     fixed-address 192.168.84.12;
  }
  host adslap3 {
     hardware ethernet 70:58:12:20:4E:7E;
     ddns-hostname "adslap3";
     fixed-address 192.168.84.13;
  }
  host adslap4 {
     hardware ethernet 70:58:12:20:4E:D3;
     ddns-hostname "adslap4";
     fixed-address 192.168.84.14;
  }
  host adslap5 {
     hardware ethernet 70:58:12:20:4E:6B;
     ddns-hostname "adslap5";
     fixed-address 192.168.84.15;
  }
  host adslap6 {
     hardware ethernet 70:58:12:20:4E:85;
     ddns-hostname "adslap6";
     fixed-address 192.168.84.16;
  }
  host hsrl {
     hardware ethernet 00:a0:a5:55:05:b2;
     ddns-hostname "hsrl";
     fixed-address 192.168.84.120;
  }
  host hsrllap {
     hardware ethernet 5C:26:0A:58:F5:03;
     ddns-hostname "hsrllap";
     fixed-address 192.168.84.121;
  }
  host hsrllap2 {
     hardware ethernet 5C:26:0A:6B:0C:94;
     ddns-hostname "hsrllap2";
     fixed-address 192.168.84.122;
  }
  host hsrlkvm {
     hardware ethernet 00:80:A3:8C:79:CB;
     ddns-hostname "hsrlkvm";
     fixed-address 192.168.84.123;
  }

  # Britt Stephen's AO2 instrument
  host ao2-daq {
     hardware ethernet 00:06:d5:10:98:fe;
     ddns-hostname "ao2-daq";
  }
  host cvi-pc {
     hardware ethernet 00:0b:97:d8:9e:0b;
     ddns-hostname "cvi-pc";
     fixed-address 192.168.184.143;
  }
  host lams-pc {
     hardware ethernet 00:21:70:99:c0:cd;
     ddns-hostname "lams-pc";
     fixed-address 192.168.184.144;
  }
  host cvi-pc-2 {
     hardware ethernet 00:0b:97:d8:9e:0b;
     ddns-hostname "cvi-pc-2";
     fixed-address 192.168.184.146;
  }
  # CAMS
  host cams-control-b {
     hardware ethernet 00:80:2f:13:69:76;
     ddns-hostname "cams-control-b";
     fixed-address 192.168.184.147;
  }
  host cams-flow {
     hardware ethernet 00:80:2F:12:B1:77;
     ddns-hostname "cams-flow";
     fixed-address 192.168.184.148;
  }
  host cams-spectra {
     hardware ethernet 00:80:2F:12:CF:A2;
     ddns-hostname "cams-spectra";
     fixed-address 192.168.184.149;
  }
  host cams-control {
     hardware ethernet 00:80:2F:12:C2:CA;
     ddns-hostname "cams-control";
     fixed-address 192.168.184.150;
  }
#
# DC-3 & DC3-Test
#
  host smps-daq {
     hardware ethernet 00:06:D5:10:98:6F;
     ddns-hostname "smps-daq";
     fixed-address 192.168.84.151;
  }
}
